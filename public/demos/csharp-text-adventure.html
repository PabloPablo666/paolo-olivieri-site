<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>C# Text Adventure (Web Demo)</title>

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: #000;
      color: #0f0;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      overflow: hidden;
    }

    #terminal {
      display: flex;
      flex-direction: column;
      height: 100vh;
      width: 100vw;
      box-sizing: border-box;
      padding: 16px;
      gap: 10px;
    }

    h2 {
      margin: 0;
      font-size: 18px;
      font-weight: 700;
      letter-spacing: 0.3px;
    }

    /* Output: testo wrappa, niente scroll orizzontale */
    #out {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;     /* no sideways scrolling */
      line-height: 1.25;
      padding: 12px;
      box-sizing: border-box;
      border: 1px solid rgba(0,255,0,.55);
      background: rgba(0,0,0,.55);
      text-shadow: 0 0 2px rgba(0,255,0,0.35);
      font-size: 14px;
    }

    /* testo normale: WRAP */
    .out-text {
  white-space: pre-wrap;
  display: inline; /* lascia com'è, ma qui non serve altro */
}

    /* ASCII: NO WRAP, ma auto-fit per blocco (JS) */
    pre.out-ascii {
  white-space: pre;
  margin: 0 0 25px 0;  /* spazio sotto il disegno */
  padding: 0;
  line-height: 1.1;
}

    .row {
      display: flex;
      gap: 10px;
      flex-wrap: nowrap;
      align-items: center;
    }

    #cmd {
      flex: 1 1 auto;
      min-width: 240px;
      padding: 10px;
      background: rgba(0,0,0,0.85);
      color: #0f0;
      border: 1px solid #0f0;
      box-sizing: border-box;
      outline: none;
      text-shadow: 0 0 2px rgba(0,255,0,0.35);
      font-family: inherit;
      font-size: 14px;
    }

    button {
      padding: 10px 14px;
      background: #0f0;
      color: #000;
      border: 0;
      font-weight: 800;
      cursor: pointer;
      flex: 0 0 auto;
    }

    button.secondary {
      background: rgba(0,0,0,.85);
      color: #0f0;
      border: 1px solid #0f0;
    }

    .muted {
      opacity: .9;
      font-size: 12px;
      line-height: 1.35;
      border: 1px solid rgba(0,255,0,.25);
      padding: 10px 12px;
      background: rgba(0,0,0,.35);
    }

    .kbd {
      border: 1px solid rgba(0,255,0,.5);
      padding: 2px 6px;
      border-radius: 6px;
      display: inline-block;
      margin: 0 2px;
    }
  </style>
</head>

<body>
  <div id="terminal">
    <h2>Text Adventure (C# Web Adaptation)</h2>

    <div id="out"></div>

    <div class="row">
      <input id="cmd" placeholder="Type a command..." autocomplete="off" />
      <button id="send">Send</button>
      <button id="reset" class="secondary">Reset</button>
    </div>

    <div class="muted">
      Commands are <b>strict</b>. Examples:
      <span class="kbd">YES</span> <span class="kbd">NO</span>
      <span class="kbd">LEFT</span> <span class="kbd">RIGHT</span> <span class="kbd">STRAIGHT</span>
    </div>
  </div>


  <!-- =========================================================
       ASCII ART (SAFE)
       - Stored in <template> so JS never parses backslashes.
       - We read it with textContent at runtime.
  ========================================================== -->

  <template id="art-writing0"><pre>
                                                                  __          __  ______   _        _____   ____    __  __  ______
                                                                  \ \        / / |  ____| | |      / ____| / __ \  |  \/  ||  ____|
                                                                   \ \  /\  / /  | |__    | |     | |     | |  | | | \  / || |__
                                                                    \ \/  \/ /   |  __|   | |     | |     | |  | | | |\/| ||  __|
                                                                     \  /\  /    | |____  | |____ | |____ | |__| | | |  | || |____
                                                                      \/  \/     |______| |______| \_____| \____/  |_|  |_||______|
  </pre></template>

  <template id="art-writing1"><pre>



                         _________          _______             _______           _       _________ _______  ______     _______  _______  _        _______ _________ _______  _
                         \__   __/|\     /|(  ____ \  |\     /|(  ___  )|\     /|( (    /|\__   __/(  ____ \(  __  \   (       )(  ___  )( (    /|(  ____ \\__   __/(  ___  )( (    /|
                            ) (   | )   ( || (    \/  | )   ( || (   ) || )   ( ||  \  ( |   ) (   | (    \/| (  \  )  | () () || (   ) ||  \  ( || (    \/   ) (   | (   ) ||  \  ( |
                            | |   | (___) || (__      | (___) || (___) || |   | ||   \ | |   | |   | (__    | |   ) |  | || || || (___) ||   \ | || (_____    | |   | |   | ||   \ | |
                            | |   |  ___  ||  __)     |  ___  ||  ___  || |   | || (\ \) |   | |   |  __)   | |   | |  | |(_)| ||  ___  || (\ \) |(_____  )   | |   | |   | || (\ \) |
                            | |   | (   ) || (        | (   ) || (   ) || |   | || | \   |   | |   | (      | |   ) |  | |   | || (   ) || | \   |      ) |   | |   | |   | || | \   |
                            | |   | )   ( || (____/\  | )   ( || )   ( || (___) || )  \  |   | |   | (____/\| (__/  )  | )   ( || )   ( || )  \  |/\____) |___) (___| (___) || )  \  |
                            )_(   |/     \|(_______/  |/     \||/     \|(_______)|/    )_)   )_(   (_______/(______/   |/     \||/     \||/    )_)\_______)\_______/(_______)|/    )_)



  </pre></template>

  <template id="art-landscape0"><pre>



           _    _                |
    ____________ .' '.    _____/----/-\ .' './========\   / \
   //// ////// /V_.-._\  |.-.-.|===| _ |-----| u    u |  /___\
  // /// // ///==\ u |.  || | ||===||||| |T| |   ||   | .| u |_ _ _ _ _ _
 ///////-\////====\==|:::::::::::::::::::::::::::::::::::|u u| U U U U U
 |----/\u |--|++++|..|'''''''''''::::::::::::::''''''''''|+++|+-+-+-+-+-+
 |u u|u | |u ||||||..|              '::::::::'           |===|>=== _ _ ==
 |===|  |u|==|++++|==|              .::::::::.           | T |....| V |..
 |u u|u | |u ||HH||         \|/    .::::::::::.
 |===|_.|u|_.|+HH+|_              .::::::::::::.              _
                __(_)___         .::::::::::::::.         ___(_)__



  </pre></template>

  <template id="art-landscape2"><pre>



                )
            (            ./\.
         |^^^^^^^^^|   ./LLLL\.
         |`.'`.`'`'| ./LLLLLLLL\.
         |.'`'.'`.'|/LLLL/^^\LLLL\.
         |.`.''``./LLLL/^ () ^\LLLL\.
         |.'`.`./LLLL/^  =   = ^\LLLL\.
         |.`../LLLL/^  _.----._  ^\LLLL\.
         |'./LLLL/^ =.' ______ `.  ^\LLLL\.
         |/LLLL/^   /|--.----.--|\ = ^\LLLL\.
       ./LLLL/^  = |=|__|____|__|=|    ^\LLLL\.
     ./LLLL/^=     |*|~~|~~~~|~~|*|   =  ^\LLLL\.
   ./LLLL/^        |=|--|----|--|=|        ^\LLLL\.
 ./LLLL/^      =   `-|__|____|__|-' =        ^\LLLL\.
/LLLL/^   =         `------------'        =    ^\LLLL\
~~|.~       =        =      =          =         ~.|~~
  ||     =      =      = ____     =         =     ||
  ||  =               .-'    '-.        =         ||
  ||     _..._ =    .'  .-()-.  '.  =   _..._  =  ||
  || = .'_____`.   /___:______:___\   .'_____`.   ||
  || .-|---.---|-.   ||  _  _  ||   .-|---.---|-. ||
  || |=|   |   |=|   || | || | ||   |=|   |   |=| ||
  || |=|___|___|=|=  || | || | ||=  |=|___|___|=| ||
  || |=|~~~|~~~|=|   || | || | ||   |=|~~~|~~~|=| ||
  || |*|   |   |*|   || | || | ||  =|*|   |   |*| ||
  || |=|---|---|=| = || | || | ||   |=|---|---|=| ||
  || |=|   |   |=|   || | || | ||   |=|   |   |=| ||
  || `-|___|___|-'   ||o|_||_| ||   `-|___|___|-' ||
  ||  '---------`  = ||  _  _  || =  `---------'  ||
  || =   =           || | || | ||      =     =    ||
  ||  %@&   &@  =    || |_||_| ||  =   @&@   %@ = ||
  || %@&@% @%@&@    _||________||_   &@%&@ %&@&@  ||
  ||,,\\V//\\V//, _|___|------|___|_ ,\\V//\\V//,,||
  |--------------|____/--------\____|--------------|
 /- _  -  _   - _ -  _ - - _ - _ _ - _  _-  - _ - _ \
/____________________________________________________\



  </pre></template>

  <template id="art-animal2"><pre>



|                           ,,'````````````',,                              |
X                        ,'`                   `',                          X
|                      ,'                         ',                        |
X                    ,'          ;       ;          ',                      X
|       (           ;             ;     ;             ;     (               |
X        )         ;              ;     ;              ;     )              X
|       (         ;                ;   ;                ;   (               |
X        )    ;   ;    ,,'```',,,   ; ;   ,,,'```',,    ;   ;               X
|       (    ; ',;   '`          `',   ,'`          `'   ;,' ;              |
X        )  ; ;`,`',  _--~~~~--__   ' '   __--~~~~--_  ,'`,'; ;     )       X
|       (    ; `,' ; :  /       \~~-___-~~/       \  : ; ',' ;     (        |
X  )     )   )',  ;   -_\  o    /  '   '  \    o  /_-   ;  ,'       )   (   X
| (     (   (   `;      ~-____--~'       '~--____-~      ;'  )     (     )  |
X  )     )   )   ;            ,`;,,,   ,,,;',            ;  (       )   (   X
| (     (   (  .  ;        ,'`  (__ '_' __)  `',        ;  . )     (     )  |
X  )     \/ , .). ';    ,'`        ~~ ~~        `',    ;  .(. , \/  )   (   X
| (   , ,'|// / (/ ,;  '        _--~~-~~--_        '  ;, \)    \|', ,    )  |
X ,)  , \/ \|  \,/  ;;       ,; |_| | |_| ;,       ;;  \,//  |/ \/ ,   ,   X
| ,   .| \_ |\/ |#\_/;       ;_| : `~'~' : |_;       ;\_/#| \/| _/ |.   ,   |
X#(,'  )  \\\#\ \##/)#;     :  `\/       \/   :     ;#(\##/ /#///  (  ',)# ,X
|| ) | \ |/ /#/ |#( \; ;     :               ;     ; ;/ )#| \#\ \| / | ( |) |
X\ |.\\ |\_/#| /#),,`   ;     ;./\_     _/\. ;     ;   `,,(#\ |#\_/| //. | / ,X
| \\_/# |#\##/,,'`       ;     ~~--|~|~|--~~     ;       `',,\##/#| #\_// \/|
X  ##/#  #,,'`            ;        ~~~~~        ;            `',,#  #\##  //X
|####@,,'`                 `',               ,'`                 `',,@####| |
X#,,'`                        `',         ,'`                        `',,###X
|'  spb                          ~~-----~~                               `' |



  </pre></template>

  <template id="art-object0"><pre>



                )
            (            ./\.
         |^^^^^^^^^|   ./LLLL\.
         |`.'`.`'`'| ./LLLLLLLL\.
         |.'`'.'`.'|/LLLL/^^\LLLL\.
         |.`.''``./LLLL/^ () ^\LLLL\.
         |.'`.`./LLLL/^  =   = ^\LLLL\.
         |.`../LLLL/^  _.----._  ^\LLLL\.
         |'./LLLL/^ =.' ______ `.  ^\LLLL\.
         |/LLLL/^   /|--.----.--|\ = ^\LLLL\.
       ./LLLL/^  = |=|__|____|__|=|    ^\LLLL\.
     ./LLLL/^=     |*|~~|~~~~|~~|*|   =  ^\LLLL\.
   ./LLLL/^        |=|--|----|--|=|        ^\LLLL\.
 ./LLLL/^      =   `-|__|____|__|-' =        ^\LLLL\.
/LLLL/^   =         `------------'        =    ^\LLLL\
~~|.~       =        =      =          =         ~.|~~
  ||     =      =      = ____     =         =     ||
  ||  =               .-'    '-.        =         ||
  ||     _..._ =    .'  .-()-.  '.  =   _..._  =  ||
  || = .'_____`.   /___:______:___\   .'_____`.   ||
  || .-|---.---|-.   ||  _  _  ||   .-|---.---|-. ||
  || |=|   |   |=|   || | || | ||   |=|   |   |=| ||
  || |=|___|___|=|=  || | || | ||=  |=|___|___|=| ||
  || |=|~~~|~~~|=|   || | || | ||   |=|~~~|~~~|=| ||
  || |*|   |   |*|   || | || | ||  =|*|   |   |*| ||
  || |=|---|---|=| = || | || | ||   |=|---|---|=| ||
  || |=|   |   |=|   || | || | ||   |=|   |   |=| ||
  || `-|___|___|-'   ||o|_||_| ||   `-|___|___|-' ||
  ||  '---------`  = ||  _  _  || =  `---------'  ||
  || =   =           || | || | ||      =     =    ||
  ||  %@&   &@  =    || |_||_| ||  =   @&@   %@ = ||
  || %@&@% @%@&@    _||________||_   &@%&@ %&@&@  ||
  ||,,\\V//\\V//, _|___|------|___|_ ,\\V//\\V//,,||
  |--------------|____/--------\____|--------------|
 /- _  -  _   - _ -  _ - - _ - _ _ - _  _-  - _ - _ \
/____________________________________________________\



  </pre></template>

  <template id="art-animal0"><pre>



                ____     ____
                /'    |   |    \
              /    /  |   | \   \
            /    / |  |   |  \   \
           (   /   |  """"   |\   \       Ahhh HA!!!
           | /   / /^\    /^\  \  _|
            ~   | |   |  |   | | ~
                | |__O|__|O__| |
              /~~      \/     ~~\
             /   (      |      )  \
       _--_  /,   \____/^\___/'   \  _--_
     /~    ~\ / -____-|_|_|-____-\ /~    ~\
   /________|___/~~~~\___/~~~~\ __|________\
--~~~          ^ |     |   |     |  -     :  ~~~~~:~-_     ___-----~~~~~~~~|
 /             \`^-^-^'   \`^-^-^'                  :  ~\ /'   ____/--------|
     --                                            ;   |/~~~------~~~~~~~~~|
;                                    :              :    |----------/--------|
:                     ,                           ;    .  |---\\--------------|
:     -                          .                  : : |______________-__|
:              ,                 ,                :   /'~----___________|
__  \\\        ^                          ,, ;; ;; ;._-~
~~~-----____________________________________----~~~



  </pre></template>

  <template id="art-mansion0"><pre>



                                                                                 .-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-.
                                                                               .'                                                     '.
                                                                              /       THE MANSION: MAIN ENTRANCE (RAIN-SOAKED)          \
                                                                             /___________________________________________________________\
                                                                             |                                                           |
                                                                             |                 .---------------------------.             |
                                                                             |                 |        _________         |             |
                                                                             |                 |       /   ____  \        |             |
                                                                             |                 |      /   / __ \  \       |             |
                                                                             |                 |     |   | |  | |  |      |             |
                                                                             |                 |     |   | |__| |  |      |             |
                                                                             |                 |     |   |  __  |  |      |             |
                                                                             |                 |     |   | |  | |  |      |             |
                                                                             |                 |     |   | |  | |  |      |             |
                                                                             |                 |     |   | |__| |  |      |             |
                                                                             |                 |      \   \____/  /       |             |
                                                                             |                 |       \_________/        |             |
                                                                             |                 |         _  _            |             |
                                                                             |                 |        ( \/ )           |             |
                                                                             |                 |         \  /            |             |
                                                                             |                 |          \/             |             |
                                                                             |                 '---------------------------'             |
                                                                             |                                                           |
                                                                             |      /\      /\            /\      /\            /\       |
                                                                             |     /  \____/  \          /  \____/  \          /  \      |
                                                                             |    /            \        /            \        /    \     |
                                                                             |___/______________\______/______________\______/______\____|
                                                                               |   |          |   |    |   |      |   |    |   |   |
                                                                               |___|__________|___|____|___|______|___|____|___|___|
                                                                                   ~  rain drips, metal groans, and the door listens  ~



  </pre></template>

  <template id="art-mansion1"><pre>



  _____________________________________________________________________________________________________________________________________________________________
 |                                                                                                                                                             |
 |    You step inside. The air is dry. The house is not.                                                                                                       |
 |_____________________________________________________________________________________________________________________________________________________________|
 |                                                                                                                                                             |
 |                | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |                 |
 |                | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |                 |
 |                | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |                 |
 |                | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |                 |
 |                                                                                                                                                             |
 |                                       .-._                                                                                                                  |
 |                                      /     \                                                                                                                 |
 |                                     /  _ _  \                                                                                                                |
 |                                    |  (o o)  |                                                                                                               |
 |                                    |   \_/   |                                                                                                               |
 |                                     \       /                                                                                                                |
 |                                      '.___.'                                                                                                                 |
 |                                                                                                                                                             |
 |                 ____________________________________________                                    ____________________________________________                   |
 |                |                                            |                                  |                                            |                  |
 |                |       _                      _             |                                  |             _                      _       |                  |
 |                |      |_|                    |_|            |                                  |            |_|                    |_|      |                  |
 |                |      |_|                    |_|            |                                  |            |_|                    |_|      |                  |
 |                |      |_|                    |_|            |                                  |            |_|                    |_|      |                  |
 |                |____________________________________________|                                  |____________________________________________|                  |
 |                                                                                                                                                             |
 |                                                    _________________________________                                                                        |
 |                                                   /                                 \                                                                       |
 |                                                  /     A LONG HALLWAY DISAPPEARS      \                                                                      |
 |                                                 /_____________________________________\                                                                     |
 |                                                                                                                                                             |
 |_____________________________________________________________________________________________________________________________________________________________|



  </pre></template>

  <template id="art-mansion2"><pre>



  _____________________________________________________________________________________________________________________________________________________________
 |                                                                                                                                                             |
 |    You step inside. The air is dry. The house is not.                                                                                                       |
 |_____________________________________________________________________________________________________________________________________________________________|
 |                                                                                                                                                             |
 |                | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |                 |
 |                | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |                 |
 |                | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |                 |
 |                | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | |                 |
 |                                                                                                                                                             |
 |                                       .-._                                                                                                                  |
 |                                      /     \                                                                                                                 |
 |                                     /  _ _  \                                                                                                                |
 |                                    |  (o o)  |                                                                                                               |
 |                                    |   \_/   |                                                                                                               |
 |                                     \       /                                                                                                                |
 |                                      '.___.'                                                                                                                 |
 |                                                                                                                                                             |
 |                 ____________________________________________                                    ____________________________________________                   |
 |                |                                            |                                  |                                            |                  |
 |                |       _                      _             |                                  |             _                      _       |                  |
 |                |      |_|                    |_|            |                                  |            |_|                    |_|      |                  |
 |                |      |_|                    |_|            |                                  |            |_|                    |_|      |                  |
 |                |      |_|                    |_|            |                                  |            |_|                    |_|      |                  |
 |                |____________________________________________|                                  |____________________________________________|                  |
 |                                                                                                                                                             |
 |                                                    _________________________________                                                                        |
 |                                                   /                                 \                                                                       |
 |                                                  /     A LONG HALLWAY DISAPPEARS      \                                                                      |
 |                                                 /_____________________________________\                                                                     |
 |                                                                                                                                                             |
 |_____________________________________________________________________________________________________________________________________________________________|



  </pre></template>

  <template id="art-mansion3"><pre>



  _____________________________________________________________________________________________________________________________________________________________
 |                                                                                                                                                             |
 |                                                          BASEMENT                                                                                            |
 |_____________________________________________________________________________________________________________________________________________________________|
 |                                                                                                                                                             |
 |                         ___________                                                                                                                           |
 |                        /          /|                                                                                                                          |
 |                       /__________/ |                                                                                                                          |
 |                       |          | |                                                                                                                          |
 |                       |   ____   | |                                                                                                                          |
 |                       |  |    |  | |                                                                                                                          |
 |                       |  |____|  | |                                                                                                                          |
 |                       |__________|/                                                                                                                           |
 |                                                                                                                                                             |
 |                 ________________________________________________                                                                                              |
 |                /                                                \                                                                                             |
 |               /    stone steps descend into a darkness that      \                                                                                            |
 |              /     feels thicker than air                        \                                                                                           |
 |             /____________________________________________________\                                                                                          |
 |                                                                                                                                                             |
 |                         ||                                                                                                                                    |
 |                         ||                                                                                                                                    |
 |                         ||               . . .                                                                                                               |
 |                         ||            .':':':':'.                                                                                                            |
 |                         ||          .':':':':':':':.                                                                                                         |
 |                         ||         ':':':':':':':':':                                                                                                        |
 |                         ||         ':':':':':':':':':                                                                                                        |
 |                         ||          ':.':':':':':'.:'                                                                                                        |
 |                         ||             '::.. ..::'                                                                                                           |
 |                         ||                 ||                                                                                                                |
 |                         ||                 ||                                                                                                                |
 |                         ||                 ||                                                                                                                |
 |                         ||              ___||___                                                                                                             |
 |                        _||_            /   ||   \                                                                                                            |
 |                      .'____'.         /____||____\                                                                                                           |
 |                     /  ____  \             ||                                                                                                                |
 |                    /__/    \__\            _||_                                                                                                               |
 |                                                                                                                                                             |
 |_____________________________________________________________________________________________________________________________________________________________|



  </pre></template>

  <template id="art-mansion4"><pre>



  _____________________________________________________________________________________________________________________________________________________________
 |                                                                                                                                                             |
 |                                                           LIBRARY                                                                                            |
 |_____________________________________________________________________________________________________________________________________________________________|
 |                                                                                                                                                             |
 |      |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||      |
 |      ||   ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____    ____     ||      |
 |      ||  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|    ||      |
 |      ||  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|    ||      |
 |      ||  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|    ||      |
 |      ||  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|  |____|    ||      |
 |      ||__________________________________________________________________________________________________________________________________________________||      |
 |                                                                                                                                                             |
 |                                                                                 .-""""""""""-.                                                               |
 |                                                                                /   ________   \                                                              |
 |                                                                               /   /  ____  \   \                                                             |
 |                                                                              |   |  |    |  |   |                                                            |
 |                                                                              |   |  |____|  |   |                                                            |
 |                                                                              |   |   ____   |   |                                                            |
 |                                                                              |   |  |    |  |   |                                                            |
 |                                                                              |   |__|____|__|   |                                                            |
 |                                                                               \                /                                                             |
 |                                                                                '._          _.'                                                              |
 |                                                                                    '------'                                                                  |
 |                                                                                                                                                             |
 |                                                   ___________________________                                                                                |
 |                                                  /                           \                                                                               |
 |                                                 /     A SINGLE BOOK WAITS     \                                                                              |
 |                                                /______________________________\                                                                             |
 |                                                                                                                                                             |
 |_____________________________________________________________________________________________________________________________________________________________|



  </pre></template>

  <template id="art-the_end"><pre>



  _______ _________ _
 (  ____ \\__   __/( (    /|
 | (    \/   ) (   |  \  ( |
 | (__       | |   |   \ | |
 |  __)      | |   | (\ \) |
 | (         | |   | | \   |
 | )      ___) (___| )  \  |
 |/       \_______/|/    )_)



  </pre></template>

<script>
/* ---------------------------------------------------------
   TEXTS
--------------------------------------------------------- */
const TEXTS = {
  "welcome.askName": "What is your name?:",
  "welcome.hello": "Hello, {name}! Welcome to...",
  "intro.long": "As the rain pelts down relentlessly, you find yourself standing outside a dilapidated mansion shrouded in darkness. Lightning streaks across the sky, illuminating the imposing structure before you. The wind howls through the trees, adding an eerie atmosphere to the scene. You have heard rumors about this mansion - whispers of its haunted past, of strange occurrences that defy explanation. Yet, despite the warnings, something draws you closer, a curiosity that refuses to be ignored.",
  "intro.question": "Do you dare to step inside and uncover the secrets hidden within its walls?... [Type YES or NO]",
  "hub.description": "Taking a deep breath to steady your nerves, you push open the creaking gate and step onto the overgrown path leading to the mansion's entrance. The rain soaks through your clothes, chilling you to the bone as you approach the looming structure. As you stand before the massive oak doors, you can't shake the feeling of being watched. The darkness seems to press in around you, suffocating and heavy. Ignoring the prickling sensation at the back of your neck, you glance around, trying to decide which direction to explore first. To your left, a decrepit outbuilding stands, its windows dark and foreboding. On the right, a tangled path winds through the overgrown garden, leading to an obscured structure. Straight ahead, the imposing facade of the mansion rises, its grandeur marred by neglect and time. Where will your curiosity lead you? Left, right, or straight ahead?",
  "hub.prompt": "Type LEFT, RIGHT or STRAIGHT:",
  "left.enter": "With a sense of trepidation, you decide to explore the decrepit outbuilding to your left. As you approach, the sound of the rain seems to fade, replaced by an eerie silence that hangs heavy in the air. The structure looms before you, its walls weathered and cracked, giving it a haunted appearance.",
  "left.shedIntro": "You stand before the closed door of the outbuilding, unsure of what lies beyond. Will you knock to announce your presence, attempt to open the door, or perhaps decide it's best to come back later?",
  "left.shedPrompt": "Type OPEN, KNOCK or COME BACK LATER:",
  "left.monster": "The door opens and you find yourself face to face with a towering monster. Its sharp claws glisten in the dim light, and its eyes fixate you with a menacing glare. You realize you have two options: fight or run.",
  "left.fightPrompt": "Type FIGHT or RUN:",
  "left.weaponPrompt": "Choose a weapon. Will you pick WEAPON A or WEAPON B?",
  "left.runInsult": "You run like a neurotic coward back to the entrance of the mansion.",
  "right.desc": "The garden path twists and turns through overgrown weeds. Shadows move strangely in the storm.",
  "straight.locked": "The door is locked! See if one of your three keys will open it.",
  "keys.prompt": "Type 1, 2 or 3:",
  "key.1": "You choose the first key. Lucky choice! The door opens and NOTHING is there. Strange...",
  "key.2": "You choose the second key. The door doesn't open.",
  "key.3": "You choose the third key. The door doesn't open.",
  "knock.wrong": "You answered incorrectly. The door remains closed.",
  "end.chicken": "NOT MUCH OF AN ADVENTURE IF YOU ARE A CHICKEN!",
  "mansion.intro": "The air inside is dry, as if the mansion has been holding its breath for decades. Your footsteps echo. Somewhere, something listens.",
  "mansion.choice1": "Type UPSTAIRS, BASEMENT or LIBRARY:",
  "mansion.upstairs": "The staircase groans under your weight. The second floor corridor is lined with portraits whose eyes seem… wrong.",
  "mansion.choice2_upstairs": "Type OPEN DOOR or TURN BACK:",
  "end.upstairs": "Behind the door: a small room, a broken music box, and a journal with your name written inside. You were expected. Somehow, you win.",
  "end.turnback": "You turn back. The stairs are no longer there. The mansion rearranges itself around you. You become another rumor.",
  "mansion.basement": "Cold rises from below. The basement smells of wet stone and old metal. You feel your pulse in your teeth.",
  "end.basement": "A whisper says your name. The lantern dies. The darkness doesn’t. Game over.",
  "mansion.library": "Dusty shelves, thousands of books. A single candle burns without melting. On a pedestal: one book, already open.",
  "mansion.choice2_library": "Type READ BOOK, BURN BOOK or LEAVE:",
  "end.read": "You read one page. The storm outside stops. The mansion relaxes. You step out into a morning that feels earned.",
  "end.burn": "The book ignites too easily. The flames climb the shelves like they’ve been waiting. The mansion screams. So do you.",
  "end.leave": "You leave the library and find the front door open. The mansion lets you go. That’s never a good sign."
};

/* ---------------------------------------------------------
   ASCII loader (safe)
--------------------------------------------------------- */
function loadArt(templateId) {
  const t = document.getElementById(templateId);
  if (!t) return "";
  return t.content.textContent.replace(/\s+$/g, "\n");
}

const ART = {
  writing0:   loadArt("art-writing0"),
  writing1:   loadArt("art-writing1"),
  landscape0: loadArt("art-landscape0"),
  landscape2: loadArt("art-landscape2"),
  animal2:    loadArt("art-animal2"),
  object0:    loadArt("art-object0"),
  animal0:    loadArt("art-animal0"),
  mansion0:   loadArt("art-mansion0"),
  mansion1:   loadArt("art-mansion1"),
  mansion2:   loadArt("art-mansion2"),
  mansion3:   loadArt("art-mansion3"),
  mansion4:   loadArt("art-mansion4"),
  the_end:    loadArt("art-the_end"),
};

/* ---------------------------------------------------------
   Output helpers: wrap text, keep ASCII intact, fit ASCII blocks
--------------------------------------------------------- */
function outEl() { return document.getElementById("out"); }

const OUT_TEXT_FONT_PX   = 14;
const ASCII_FONT_BASE_PX = 14;
const ASCII_FONT_MIN_PX  = 8;

function resetOut() {
  const o = outEl();
  o.textContent = "";
  o.style.fontSize = OUT_TEXT_FONT_PX + "px";
}

function scrollToBottom() {
  const o = outEl();
  o.scrollTop = o.scrollHeight;
}

function appendTextChunk(text) {
  const o = outEl();
  const span = document.createElement("span");
  span.className = "out-text";
  span.textContent = text;
  o.appendChild(span);
  scrollToBottom();
}

function fitAsciiBlockToWidth(preEl) {
  const o = outEl();
  if (!preEl || !o) return;

  let size = ASCII_FONT_BASE_PX;
  preEl.style.fontSize = size + "px";

  while (preEl.scrollWidth > o.clientWidth && size > ASCII_FONT_MIN_PX) {
    size--;
    preEl.style.fontSize = size + "px";
  }
}

function appendAsciiBlock(ascii) {
  const o = outEl();
  o.appendChild(document.createTextNode("\n"));

  const pre = document.createElement("pre");
  pre.className = "out-ascii";
  pre.textContent = ascii.trimEnd() + "\n";
  pre.style.fontSize = ASCII_FONT_BASE_PX + "px";

  o.appendChild(pre);
  o.appendChild(document.createTextNode("\n"));

  fitAsciiBlockToWidth(pre);
  scrollToBottom();
}

function print(s = "") { appendTextChunk(s + "\n"); }
function printInline(s = "") { appendTextChunk(s); }

function printArt(name) {
  const art = ART[name];
  if (!art) { print(""); return; }
  appendAsciiBlock(art);
}

window.addEventListener("resize", () => {
  const o = outEl();
  if (!o) return;
  o.querySelectorAll("pre.out-ascii").forEach(fitAsciiBlockToWidth);
});

/* ---------------------------------------------------------
   Engine (same logic)
--------------------------------------------------------- */
const LS_NAME = "csharp_adv_name_v1";
let state = { mode: "ASK_NAME", name: "Traveler", hubShown: false };

function T(key, args = {}) {
  let s = TEXTS[key] ?? `[${key}]`;
  for (const [k, v] of Object.entries(args)) s = s.replaceAll(`{${k}}`, String(v ?? ""));
  return s;
}

function normalizeInput(raw) { return (raw ?? "").trim().toUpperCase(); }
function promptOptions(options) { print(`Options: ${options.join(", ")}`); }
function invalid(options) { print(`Invalid input. Options: ${options.join(", ")}`); }

function endGame(textKeyOrRaw, isKey = true) {
  print(isKey ? T(textKeyOrRaw) : textKeyOrRaw);
  printArt("the_end");
  state.mode = "END";
}

function setInput(v) {
  const el = document.getElementById("cmd");
  el.value = v ?? "";
  el.focus();
  el.setSelectionRange(el.value.length, el.value.length);
}

function start() {
  resetOut();
  state.mode = "ASK_NAME";
  state.hubShown = false;

  printArt("writing0");
  printInline("\n\n" + T("welcome.askName") + " ");

  const saved = localStorage.getItem(LS_NAME);
  setInput(saved || "");
}

function handleAskName(raw) {
  const name = (raw ?? "").trim();
  state.name = name.length ? name : "Traveler";
  localStorage.setItem(LS_NAME, state.name);

  print(`\n${T("welcome.hello", { name: state.name })}\n`);
  printArt("writing1");

  print(T("intro.long") + "\n");
  printArt("landscape0");

  state.mode = "INTRO_CHOICE";
  print(T("intro.question"));
  promptOptions(["YES", "NO"]);
}

function handleIntroChoice(raw) {
  const input = normalizeInput(raw);
  if (input === "NO") return endGame("end.chicken", true);
  if (input !== "YES") return invalid(["YES", "NO"]);
  state.mode = "HUB";
  hub();
}

function hub() {
  if (!state.hubShown) {
    print("\n" + T("hub.description") + "\n");
    state.hubShown = true;
  }
  print(T("hub.prompt"));
  promptOptions(["LEFT", "RIGHT", "STRAIGHT"]);
}

function handleHub(raw) {
  const input = normalizeInput(raw);
  if (input === "LEFT") return leftPath();
  if (input === "RIGHT") return rightPath();
  if (input === "STRAIGHT") return straightPath();
  invalid(["LEFT", "RIGHT", "STRAIGHT"]);
}

/* LEFT */
function leftPath() {
  state.mode = "LEFT_DOOR";
  print(T("left.enter") + "\n");
  printArt("landscape2");
  print(T("left.shedIntro"));
  print(T("left.shedPrompt"));
  promptOptions(["OPEN", "KNOCK", "COME BACK LATER"]);
}

function handleLeftDoor(raw) {
  const input = normalizeInput(raw);

  if (input === "OPEN") {
    state.mode = "LEFT_FIGHT";
    print(T("left.monster") + "\n");
    printArt("animal2");
    print(T("left.fightPrompt"));
    promptOptions(["FIGHT", "RUN"]);
    return;
  }

  if (input === "KNOCK") {
    print(T("knock.wrong"));
    endGame("Game over.", false);
    return;
  }

  if (input === "COME BACK LATER") {
    print("You decide to come back later.\n");
    printArt("landscape0");
    state.mode = "HUB";
    hub();
    return;
  }

  invalid(["OPEN", "KNOCK", "COME BACK LATER"]);
}

function handleLeftFight(raw) {
  const input = normalizeInput(raw);
  if (input === "RUN") {
    print(T("left.runInsult"));
    printArt("landscape0");
    state.mode = "HUB";
    hub();
    return;
  }

  if (input === "FIGHT") {
    state.mode = "LEFT_WEAPON";
    printArt("object0");
    print(T("left.weaponPrompt"));
    promptOptions(["WEAPON A", "WEAPON B"]);
    return;
  }

  invalid(["FIGHT", "RUN"]);
}

function handleLeftWeapon(raw) {
  const input = normalizeInput(raw);
  if (input === "WEAPON A") return endGame("You die.", false);
  if (input === "WEAPON B") {
    print("Monster defeated.\n");
    state.mode = "HUB";
    hub();
    return;
  }
  invalid(["WEAPON A", "WEAPON B"]);
}

/* RIGHT */
function rightPath() {
  state.mode = "HUB";
  print(T("right.desc") + "\n");
  printArt("animal0");
  hub();
}

/* STRAIGHT */
function straightPath() {
  state.mode = "KEYS";
  print(T("straight.locked"));
  print(T("keys.prompt"));
  promptOptions(["1", "2", "3"]);
}

function handleKeys(raw) {
  const input = (raw ?? "").trim();
  if (input === "1") {
    print(T("key.1") + "\n");
    printArt("mansion0");
    insideMansion();
    return;
  }
  if (input === "2") return (print(T("key.2") + "\n"), endGame("Game over.", false));
  if (input === "3") return (print(T("key.3") + "\n"), endGame("Game over.", false));
  print("Invalid key. Try 1, 2 or 3:");
}

/* MANSION */
function insideMansion() {
  state.mode = "MANSION_CHOICE1";
  print(T("mansion.intro") + "\n");
  printArt("mansion1");
  print(T("mansion.choice1"));
  promptOptions(["UPSTAIRS", "BASEMENT", "LIBRARY"]);
}

function handleMansionChoice1(raw) {
  const input = normalizeInput(raw);

  if (input === "UPSTAIRS") {
    state.mode = "MANSION_UPSTAIRS_2";
    print(T("mansion.upstairs") + "\n");
    printArt("mansion2");
    print(T("mansion.choice2_upstairs"));
    promptOptions(["OPEN DOOR", "TURN BACK"]);
    return;
  }

  if (input === "BASEMENT") {
    print(T("mansion.basement") + "\n");
    printArt("mansion3");
    endGame("end.basement", true);
    return;
  }

  if (input === "LIBRARY") {
    state.mode = "MANSION_LIBRARY_2";
    print(T("mansion.library") + "\n");
    printArt("mansion4");
    print(T("mansion.choice2_library"));
    promptOptions(["READ BOOK", "BURN BOOK", "LEAVE"]);
    return;
  }

  invalid(["UPSTAIRS", "BASEMENT", "LIBRARY"]);
}

function handleMansionUpstairs2(raw) {
  const input = normalizeInput(raw);
  if (input === "OPEN DOOR") return endGame("end.upstairs", true);
  if (input === "TURN BACK") return endGame("end.turnback", true);
  invalid(["OPEN DOOR", "TURN BACK"]);
}

function handleMansionLibrary2(raw) {
  const input = normalizeInput(raw);
  if (input === "READ BOOK") return endGame("end.read", true);
  if (input === "BURN BOOK") return endGame("end.burn", true);
  if (input === "LEAVE") return endGame("end.leave", true);
  invalid(["READ BOOK", "BURN BOOK", "LEAVE"]);
}

/* Dispatcher */
function dispatch(raw) {
  if (state.mode === "END") return print("The game has ended. Press Reset to play again.");

  if (state.mode === "ASK_NAME") return handleAskName(raw);
  if (state.mode === "INTRO_CHOICE") return handleIntroChoice(raw);
  if (state.mode === "HUB") return handleHub(raw);

  if (state.mode === "LEFT_DOOR") return handleLeftDoor(raw);
  if (state.mode === "LEFT_FIGHT") return handleLeftFight(raw);
  if (state.mode === "LEFT_WEAPON") return handleLeftWeapon(raw);

  if (state.mode === "KEYS") return handleKeys(raw);

  if (state.mode === "MANSION_CHOICE1") return handleMansionChoice1(raw);
  if (state.mode === "MANSION_UPSTAIRS_2") return handleMansionUpstairs2(raw);
  if (state.mode === "MANSION_LIBRARY_2") return handleMansionLibrary2(raw);

  print("[internal] unknown state, resetting.");
  start();
}

/* UI wiring */
document.getElementById("send").addEventListener("click", () => {
  const el = document.getElementById("cmd");
  const v = el.value;
  el.value = "";
  dispatch(v);
  el.focus();
});

document.getElementById("cmd").addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    e.preventDefault();
    document.getElementById("send").click();
  }
});

document.getElementById("reset").addEventListener("click", start);

start();
</script>
</body>
</html>
